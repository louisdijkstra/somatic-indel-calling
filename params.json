{"name":"Somatic-indel-calling","tagline":"A Bayesian latent variable model for calling somatic indels","body":"Somatic Indel Calling\r\n=====================\r\n\r\nThis repository contains the code/scripts for discovering somatic mutations by using a Bayesian latent variable model that links (next-generation sequencing) reads and their alignments to the (latent) allele frequencies of indels in both the healthy/control as the cancer/disease sample. The pipeline is written in both C and Python. \r\n\r\n***\r\n\r\n## Installation \r\n\r\n### Dependencies \r\n\r\nThe compilation of the C code requires the following libraries to be installed:  \r\n\r\n* The _GNU scientific library_ (GSL - see http://www.gnu.org/software/gsl), in particular:\r\n\t* `gsl_math.h`,\r\n\t* `gsl_min.h` and \r\n\t* `gsl_errno.h`. \r\n\r\n* The _GMP library_ for arbitrary precision arithmetic (see https://gmplib.org). \r\n\r\nand\r\n\r\n* _CMake_ (see http://www.cmake.org)\r\n\r\nThe project depends for Python on the following packages: \r\n\r\n* _PySAM_ (see https://code.google.com/p/pysam/) for working with BAM/SAM files and\r\n* _PyVCF_ (see https://github.com/jamescasbon/PyVCF) for working with VCF files. \r\n\r\nPySAM requires the installation of \r\n\r\n* _SAMtools_ (see http://samtools.sourceforge.net)\r\n\r\n### Installation instructions \r\n\r\nIn order to compile the C code in the folder `src/`, type in the main directory: \r\n\r\n```\r\n\t$ cmake . \r\n\t$ make\r\n\t$ make install \r\n```\r\n\r\nThe executable `sm_caller` will be placed in the `bin/` folder together with the Python scripts. CMake will check automatically whether the GSL and GMP libraries are installed. \r\n\r\n***\r\n\r\n## Usage \r\n\r\nFirst, make sure to set the parameters in `parameters.txt` (in the main directory). The parameters are currently set to their default values. \r\n\r\nIn order to use the somatic indel calling pipeline, type in the main directory: \r\n\r\n\t$ python call-somatic-variants.py <vcf-file> <healthy-bam> <cancer-bam>  \r\n\r\nwhere \r\n\r\n* `<vcf-file>` - sorted VCF file with potential somatic variants.\r\n\t\r\n* `<healthy-bam>` - sorted and indexed BAM file of the healthy/control sample.\r\n\t\r\n* `<cancer-bam>` - sorted and indexed BAM file of the cancer/disease sample. \r\n\r\n(One could use the option `-v` for a more elaborate output). A VCF file containing all indels deemed somatic is stored in the `results/` directory. See for a more elaborate description of the pipeline the following section. \r\n\r\n## Pipeline\r\n\r\nThe main script `call-somatic-mutations.py` executes the following steps: \r\n\r\n1. It reads in the parameters used throughout the entire pipeline from the `parameters.txt` file. \r\n\r\n2. It runs the `extract-observations.py` script; for every indel in the given VCF, the script collects all relevant alignments from the healthy/control and cancer/disease BAMs. (Relevant meaning that the alignment overlaps with the indel in question.) Both insert sizes and splits are taken into consideration.\r\nThe output is stored as a `.raw-observations` file (see the File formats section) in the `intermediate-results/` folder. \r\n\r\n3. After having collected all the relevant data, the program `bin/sm_caller` is called. This program makes the actual calls and determines the posterior probabilities of the variants to be somatic, germline or absent. The results are stored as a `.calls` file (see the File formats section) in the `intermediate-results/` folder. \r\n\r\n4. Finally, the script `bin/calls-to-vcf.py` takes in both the `.calls`-file of the previous step and the original VCF file and outputs a VCF file (in format v4.1) in the `results/` directory. Note that it only outputs the variants deemed somatic. \r\n\r\n*** \r\n\r\n## Directory structure \r\n\r\nThe repository consists of the following directories: \r\n\r\n* `bin/` - contains the Python scripts and executables used for calling the somatic mutations. \r\n\r\n* `include/` - contains the header files for the C-code.\r\n\r\n* `intermediate-results/` - will contain all the intermediate results, i.e., the so-called 'raw observations' and the 'calls' file. See for a description of their format Section File formats.\r\n\r\n* `results/` - will contain the VCF file with the somatic calls.\r\n\r\n* `python/` - contains Python code that is re-used throughout some of the scripts in the `bin`-folder.\r\n\r\n* `src/` - contains the C-code for the somatic mutation caller. \r\n\r\nIn addition, the repository contains in the main directory the file `parameters.txt`. In this file, one can set the main parameters that play a role for calling the somatic mutations. \r\n\r\n***\r\n\r\n## File formats\r\n\r\nThis section contains a description of the two (novel) file formats used in this projects: `.raw-observations` and `.calls`. \r\n\r\n### .raw-observations\r\n\r\nThis file format is used as a summary of the relevant data\r\nfrom a VCF file and two BAM files; one from the healthy and one\r\nfrom the cancer sample. Every indel in the given VCF file is \r\nrepresented by 9 lines. The first line contains information\r\non the variant and is formatted as follows (tab-delimited): \r\n\r\n\t<type>\t<chr>\t<pos>\t<length>\r\n\r\nwhere `<type>` is '+' in case of an insertion and '-' for a \r\ndeletion. The chromosome and the variant's postion are given by \r\n`<chr>` and `<pos>`. The indel's length is given by `<length>`. \r\n\r\nThe next four lines represent the data of the healthy sample. The \r\nlater four are for the cancer sample. The first line represents in\r\nboth cases the observed insert sizes. The second the associated \r\nalignment probabilities. The third line contains the split read \r\nobservations, i.e., an observation is 1 when a read contained a split \r\nthat supported the presence of the indel and a 0 otherwise. The \r\nfourth line contains the alignment probabilities associated with \r\nthe split read observations. \r\n\r\n### .calls\r\n\r\nEvery line represents one variant and consists of 10 columns in total (tab-delimited):\r\n\r\n1. _type_ - the symbol `+` represents an insertion and `-` a deletion;\r\n\r\n2. _chromosome_ - the chromosome the variant is on;\r\n\r\n3. _position_ - its position (the same as in the original VCF file);\r\n\r\n4. _length_ - the indel's length;\r\n\r\n5. estimate of the healthy variant allele frequency. This value can either be 0.0 (the variant is absent on both chromosomes), 0.5 (heterozygous for the variant) and 1.0 (homozygous for the variant); \r\n\r\n6. estimate of the cancer variant allele frequency. This value lies between 0 and 1 and reflects the proportion of cancer haplotypes that harbour the variant in question;\r\n\r\n7. the maximum loglikelihood associated with the estimates; \r\n\r\n8. the posterior probability of the variant to be SOMATIC; \r\n\r\n9. the posterior probability of the variant to be GERMLINE;  \r\n\r\n10. the posterior probability of the variant to be NOT PRESENT.    \r\n\r\n***\r\n\r\n## Contact\r\n\r\nLouis Dijkstra\r\n\r\n__E-mail__: louisdijkstra (at) gmail.com\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}